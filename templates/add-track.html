{% extends 'base.html' %}

{% block content %}
    <main>
        <div class="row">
            <form action="{{ url_for('insert_track') }}" method="POST" class="col s12"> <!-- The form will call the insert_track function located in app.py -->
                <div class="row">
                    <div class="input-field col s6">
                        <i class="material-icons prefix">assignment</i>
                        <input id="track_title" name="track_title" type="text" class="validate" required>
                        <label for="track_title">Track Title</label>
                    </div>
                    <div class="input-field col s6">
                        <i class="material-icons prefix">brush</i>
                        <input id="artist" name="artist" type="text" class="validate" required>
                        <label for="artist">Artist</label>
                    </div>
                    <div class="input-field col s6">
                        <i class="material-icons prefix">music_video</i>
                        <input id="youtube_link" name="youtube_link" type="text" class="validate" required>
                        <label for="youtube_link">YouTube Link</label>
                    </div>
                    <div class="input-field col s6">
                        <i class="material-icons prefix">calendar_today</i>
                        <input id="year" name="year" type="text" class="validate" required pattern="[0-9][0-9][0-9][0-9]">
                        <label for="icon_prefix">Year</label>
                    </div>
                    <div class="input-field col s6">
                        <i class="material-icons prefix">category</i>
                        <select id="genre" name="genre">
                            <option value="" disabled selected>Genre</option> <!-- This option won't be selectable but serves as a visual clue as to what the user should do -->
                            {% for genre in genres %}
                            <!-- If we have 4 genres in the database we'll have 4 options, if we have 10 genres in the database we'll have 10 options and so on -->
                            <option value="{{ genre.genre }}">{{ genre.genre }}</option> <!-- The value here is what will be submitted to the form -->
                            {% endfor %}
                            <option value="add-genre-link">Add a Genre</option>
                        </select>
                    </div>
                </div>
                <button class="btn waves-effect waves-light" type="submit" name="action">Add Track
                    <i class="material-icons right">send</i>
                </button>
            </form>
        </div>
    </main>
{% endblock %}

<!-- GENRE LINK SCRIPT -->
<!-- This script is identical to the one that can be found on edit-track.html -->
<!-- The duplication here is necessary, since the script relies on a url_for which will not work if placed in an external .js file, according to https://stackoverflow.com/questions/43660461/using-url-for-in-a-javascript-file-with-jinja-flask -->
{% block genre_link_js %}
    <script>
        // Listen for a change on the Genre select box
        $('#genre').change(function() {
            // Grab the current value of the select box
            var selectVal = $('select').val()
            console.log(selectVal)
            // If the select box's value is equal to 'add-genre-link'...
            if (selectVal == 'add-genre-link') {
                // Redirect the user to add-genre.html
                window.location.href = "{{ url_for('add_genre') }}";
            }
        });
    </script>
{% endblock %}